<div
  class="page-choose-files flex flex-row h-screen-minus-navbar overflow-hidden"
>
  <!-- List -->
  <div class="list basis-[15rem] border-l">
    <div class="list_items p-6 relative overflow-y-auto bg-white" #imageList>
      <koodaki-image-list
        [list]="images"
        (clickImage)="onClickImage($event)"
      ></koodaki-image-list>
    </div>
    <!-- Pagination -->
    <div class="list_pagination">
      <koodaki-paginator
        [config]="paginatorConfig"
        (changePage)="onChangePage($event)"
      ></koodaki-paginator>
    </div>
    <!-- Filter -->
    <div class="h-navbar bg-white flex flex-col justify-center">
      <mat-checkbox color="primary" [formControl]="choosenOnesControl">
        انتخاب شده ها
      </mat-checkbox>
    </div>
  </div>
  <!-- Files -->
  <div class="content border-r bg-gray-200 flex flex-auto">
    <div class="flex-none w-2/3 bg-gray-200 flex flex-col">
      <!-- Slider -->
      <div
        #slider
        class="
          flex-auto
          overflow-y-auto
          h-screen-minus-navbar
          slider
          relative
          p-3
          overflow-hidden
          flex flex-col
          justify-center
          items-center
        "
      >
        <img
          #image
          [src]="currentItem && currentItem.url"
          class=""
          [class.is-selected]="currentItem && currentItem.selected"
          alt=""
        />

        <p
          *ngIf="currentItem && currentItem.comment"
          class="mt-3 bg-white rounded-lg p-4"
        >
          {{ currentItem.comment }}
        </p>

        <!-- Navigators -->
        <div
          class="
            navigator navigator--left
            shadow-lg
            absolute
            left-0
            w-[40px]
            z-10
            bg-white
            pointer
            flex
            items-center
            justify-center
          "
          (click)="onClickNavigationPreviouse()"
        >
          &#9664;
        </div>
        <div
          class="
            navigator navigator--right
            shadow-lg
            absolute
            right-0
            w-[40px]
            z-10
            bg-white
            pointer
            flex flex-col
            items-center
            justify-center
          "
          (click)="onClickNavigationNext()"
        >
          &#9654;
        </div>
      </div>
      <!-- Toolbar -->
      <div
        class="
          toolbar
          border-t
          py-1
          px-3
          bg-white
          flex
          items-center
          justify-center
        "
      >
        <!-- Right -->
        <div
          fxFlex
          class="border-l px-3 align-left flex gap-4 justify-end"
        ></div>
        <!-- Left -->
        <div fxFlex class="px-3 flex gap-4">
          <button
            mat-icon-button
            (click)="onClickRotate()"
            matTooltip="بچرخانید"
          >
            <img
              src="assets/images/rotation.png"
              alt=""
              width="24px"
              height="24px"
            />
          </button>
        </div>
      </div>
    </div>
    <!-- Uploader -->
    <div class="flex-none w-1/3 bg-gray-300 flex flex-col p-4">
      <mat-card class="mb-8">
        <div
          #selectedFile
          class="p-4"
          #fileInput
          ng2FileDrop
          (fileOver)="fileOverBase($event)"
          (onFileDrop)="droppedFile($event)"
          [uploader]="uploader"
        >
          <p
            class="
              text-center
              p-5
              h-24
              border-3 border-dashed border-gray-300
              rounded-xl
              flex flex-col
              justify-center
              text-gray-500
            "
          >
            فایل را اینجا رها کنید
          </p>
        </div>
        <div class="p-1">
          <button
            mat-flat-button
            color="primary"
            (click)="chooseMultipleFile.click()"
            class="w-20 leading-none"
          >
            <mat-icon class="m-0 scale-150">add</mat-icon>
          </button>
          <input
            #file
            #chooseMultipleFile
            type="file"
            ng2FileSelect
            [uploader]="uploader"
            multiple
            style="display: none"
            (onFileSelected)="onFileSelected($event)"
            accept="image/x-png,image/gif,image/jpeg,image/png,application/x-zip-compressed"
          />
          <p class="text-xs mr-3 align-middle inline-block text-gray-500">
            برای انتخاب فایل اینجا کلیک کنید
          </p>
        </div>
      </mat-card>
      <button
        mat-flat-button
        color="primary"
        (click)="uploadAllFile()"
        [disabled]="uploader.getNotUploadedItems().length === 0"
      >
        <i class="material-icons align-middle">upload</i
        ><span>بارگذاری همه</span>
      </button>
      <section class="example-container mt-2" tabindex="0">
        <table
          mat-table
          [dataSource]="dataSource"
          class="mat-elevation-z8 empty:hidden"
        >
          <!-- name Column -->
          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef>نام</th>
            <td
              mat-cell
              *matCellDef="let element"
              matTooltip="{{ element.file.name }}"
            >
              {{ (element.file.name | slice: 0:55) + "..." }}
            </td>
          </ng-container>

          <!-- size Column -->
          <ng-container matColumnDef="size">
            <th mat-header-cell *matHeaderCellDef>حجم MB</th>
            <td mat-cell *matCellDef="let element" nowrap>
              {{ element?.file?.size / 1024 / 1024 | number: ".2" }}
            </td>
          </ng-container>

          <!-- progress Column -->
          <ng-container matColumnDef="progress">
            <th mat-header-cell *matHeaderCellDef>پیشرفت</th>
            <td mat-cell *matCellDef="let element">
              <mat-progress-bar
                mode="determinate"
                [value]="element.progress"
                [ngStyle]="{
                  width: element.progress + '%',
                  height: '5px'
                }"
              ></mat-progress-bar>
              {{ element.progress }}%
            </td>
          </ng-container>

          <!-- action Column -->
          <ng-container matColumnDef="action">
            <th mat-header-cell *matHeaderCellDef>عملیات</th>

            <td mat-cell *matCellDef="let row">
              <button
                mat-icon-button
                color="primary"
                (click)="uploadFileItem(row)"
                [disabled]="row.isReady || row.isUploading || row.isSuccess"
              >
                <i class="material-icons">upload</i>
                <!-- (click)="uploadFile(row)" -->
                <!-- <span class="material-icons"> upload_file </span> -->
              </button>
              <button
                mat-icon-button
                color="primary"
                (click)="row.cancel()"
                [disabled]="!row.isUploading"
              >
                <i class="material-icons">cancel</i>
                <!-- <span class="material-icons"> cancel </span> -->
              </button>
              <button mat-icon-button color="warn" (click)="deleteFile(row)">
                <i class="material-icons">delete</i>
                <!-- <span class="material-icons"> delete </span> -->
              </button>
            </td>
          </ng-container>

          <tr
            mat-header-row
            *matHeaderRowDef="displayedColumns; sticky: true"
          ></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        </table>
      </section>
    </div>
  </div>
</div>
