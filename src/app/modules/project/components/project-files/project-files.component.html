<div
  class="page-choose-files flex flex-row h-screen-minus-navbar overflow-hidden"
>
  <!-- List -->
  <div class="list basis-[15rem] border-l">
    <div class="list_items p-3 relative overflow-y-auto bg-white" #imageList>
      <koodaki-image-list
        [list]="images"
        (clickImage)="onClickImage($event)"
      ></koodaki-image-list>
    </div>
    <!-- Pagination -->
    <div class="list_pagination">
      <koodaki-paginator
        [config]="paginatorConfig"
        (clickNext)="onClickNext($event)"
        (clickPrevious)="onClickPrevious($event)"
      ></koodaki-paginator>
    </div>
    <!-- Filter -->
    <div class="h-navbar bg-white flex flex-col justify-center">
      <mat-checkbox color="primary" [formControl]="choosenOnesControl">
        انتخاب شده ها
      </mat-checkbox>
    </div>
  </div>
  <!-- Files -->
  <div
    class="
      flex-auto flex
      overflow-y-auto
      items-stretch
      h-screen-minus-navbar
      p-4
    "
  >
    <!-- Selected File -->
    <div class="flex-none w-1/2 bg-gray-300 flex flex-col justify-center p-4">
      <div
        *ngIf="!currentItem; else selectedItem"
        class="no-file-selected text-center pt-10"
      >
        <mat-icon class="text-[100px] w-[100px] h-[90px] text-gray-200"
          >panorama</mat-icon
        >
        <p class="text-gray-400 pt-2">فایلی برای مشاهده موجود نیست</p>
      </div>
      <ng-template #selectedItem>
        <img [src]="currentItem.url" [alt]="" />
      </ng-template>
    </div>
    <!-- Upload -->
    <div class="flex-none w-1/2 mx-auto p-4 bg-gray-200">
      <mat-card class="mb-8">
        <div
          #selectedFile
          class="p-4"
          #fileInput
          ng2FileDrop
          (fileOver)="fileOverBase($event)"
          (onFileDrop)="droppedFile($event)"
          [uploader]="uploader"
        >
          <p
            class="
              text-center
              p-5
              h-24
              border-4 border-dashed border-gray-300
              rounded-xl
              flex flex-col
              justify-center
              text-gray-500
            "
          >
            فایل را اینجا رها کنید
          </p>
        </div>
        <div class="">
          <button
            (click)="chooseMultipleFile.click()"
            class="
              py-1
              px-2
              bg-green-500
              text-white
              rounded-sm
              shadow-md
              w-20
              leading-none
              focus:ring-2 focus:ring-green-400 focus:ring-opacity-75
            "
          >
            <mat-icon>add</mat-icon>
          </button>
          <input
            #file
            #chooseMultipleFile
            type="file"
            ng2FileSelect
            [uploader]="uploader"
            multiple
            style="display: none"
            (onFileSelected)="onFileSelected($event)"
            accept="image/x-png,image/gif,image/jpeg,image/png,application/x-zip-compressed"
          />
          <p class="text-xs mr-3 align-super inline-block text-gray-500">
            برای انتخاب فایل اینجا کلیک کنید
          </p>
        </div>
      </mat-card>
      <button
        mat-flat-button
        color="primary"
        (click)="uploadAllFile()"
        [disabled]="uploader.getNotUploadedItems().length === 0"
      >
        <i class="material-icons align-middle">upload</i
        ><span>بارگذاری همه</span>
      </button>
      <section class="example-container mt-2" tabindex="0">
        <table
          mat-table
          [dataSource]="dataSource"
          class="mat-elevation-z8 empty:hidden"
        >
          <!-- name Column -->
          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef>نام</th>
            <td
              mat-cell
              *matCellDef="let element"
              matTooltip="{{ element.file.name }}"
            >
              {{ (element.file.name | slice: 0:55) + "..." }}
            </td>
          </ng-container>

          <!-- size Column -->
          <ng-container matColumnDef="size">
            <th mat-header-cell *matHeaderCellDef>حجم MB</th>
            <td mat-cell *matCellDef="let element" nowrap>
              {{ element?.file?.size / 1024 / 1024 | number: ".2" }}
            </td>
          </ng-container>

          <!-- progress Column -->
          <ng-container matColumnDef="progress">
            <th mat-header-cell *matHeaderCellDef>پیشرفت</th>
            <td mat-cell *matCellDef="let element">
              <mat-progress-bar
                mode="determinate"
                [value]="element.uploader.progress"
              ></mat-progress-bar>
              {{ element.progress }}
              {{ element.uploader.progress }}
            </td>
          </ng-container>

          <!-- action Column -->
          <ng-container matColumnDef="action">
            <th mat-header-cell *matHeaderCellDef>عملیات</th>

            <td mat-cell *matCellDef="let row">
              <button
                mat-icon-button
                color="primary"
                (click)="uploadFileItem(row)"
                [disabled]="row.isReady || row.isUploading || row.isSuccess"
              >
                <i class="material-icons">upload</i>
                <!-- (click)="uploadFile(row)" -->
                <!-- <span class="material-icons"> upload_file </span> -->
              </button>
              <button
                mat-icon-button
                color="primary"
                (click)="row.cancel()"
                [disabled]="!row.isUploading"
              >
                <i class="material-icons">cancel</i>
                <!-- <span class="material-icons"> cancel </span> -->
              </button>
              <button mat-icon-button color="warn" (click)="deleteFile(row)">
                <i class="material-icons">delete</i>
                <!-- <span class="material-icons"> delete </span> -->
              </button>
            </td>
          </ng-container>

          <tr
            mat-header-row
            *matHeaderRowDef="displayedColumns; sticky: true"
          ></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        </table>
      </section>
    </div>
  </div>
</div>
